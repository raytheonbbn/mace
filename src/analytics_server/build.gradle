/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.0.2/samples
 */


// Plugins
plugins {
    id 'java'
    id 'application'
    id 'eclipse'
}

// Enable integration of Maven repositories
repositories {
    // You can declare any Maven/Ivy/file repository here.

    mavenCentral()

    flatDir {
        dirs 'libs'
    }

    maven {
        url file('mavenRepos')
    }
}

// Project dependencies
dependencies {
    // Logger
    implementation group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.15.0'
    implementation group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.15.0'

    // JSON
    implementation 'com.google.code.gson:gson:2.8.2'
    
    // MQTT
    // https://mvnrepository.com/artifact/org.eclipse.paho/org.eclipse.paho.client.mqttv3
    implementation group: 'org.eclipse.paho', name: 'org.eclipse.paho.client.mqttv3', version: '1.2.5'

    // CSV Logger
    // https://mvnrepository.com/artifact/com.opencsv/opencsv
    implementation group: 'com.opencsv', name: 'opencsv', version: '3.7'

    // JUnit
	testImplementation(platform('org.junit:junit-bom:5.7.2'))
	testImplementation('org.junit.jupiter:junit-jupiter')

}

test {
	useJUnitPlatform()
	testLogging {
        exceptionFormat "full"
        events "skipped", "passed", "failed"
        showStandardStreams = true
	}
}

task copyToLib(type: Copy) {
    into "$buildDir/dependencies"
    from configurations.default
}

application {
    mainClass = 'com.bbn.mace.server.Server'
}


project.version = '0.1'

jar {
    dependsOn copyToLib
    version = project.version
    manifest {
        attributes 'Implementation-Title': 'MACE Analytics Server',
                'Implementation-Version': project.version,
                'Main-Class': 'com.bbn.mace.server.Server'
    }
}
